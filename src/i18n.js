// src/i18n.js — simple, robust i18n with safe defaults

const STORAGE_KEY = 'tcf_lang';

// ----- Translations dictionary -----
const dict = {
  en: {
    applyFailed: "Apply failed",
    applyTemplate: "Apply template",
    renameTemplate: "Rename template",
    confirmDeleteTemplate: "Delete template \"{name}\"?",
    templateNamePrompt: "Template name:",
    saveAsTemplate: "Save as template",
    exportTemplates: "Export templates",
    importTemplates: "Import templates",
    templatesEmpty: "No templates yet",
    templatesMenu: "Templates",
    templates: "Templates",
    // Header / top bar
    language: 'Language',
    scheme: 'Color scheme',
    appTitle: 'Interface Generator',

    // Home
    home: 'Home',
    chooseInterface: 'Home',
    clickToGo: 'Choose an interface to start',
    result: 'Result',
    copy: 'Copy',
    combineAll: 'Combine from all interfaces',
    orderInterfaces: 'Interfaces order',
    download: 'Download',
    clearSection: 'Clear section',
    clear: 'Clear',
    notAllRequired: 'Please fill all required fields',
    fillDefaults: 'Fill in default values',

    // Sidebar / Menu
    tools: 'Tools',
        searchAria: 'Search',
    clear: 'Clear',

    

    // Admin / list
    adminPanel: 'Admin panel',
    adminTitle: 'WMS Interface Generator',
    overview: 'Overview',
    search: 'Search interface...',
    addInterface: 'Add interface',
    export: 'Export JSON',
    import: 'Import WMS (json)',
    importAddNew: 'Add new',
    importOverwriteSelected: 'Overwrite selected',
    category: 'Category',
    fieldsCount: 'Fields',
    deleteInterface: 'Delete interface',
    confirmDeleteInterface: 'Are you sure you want to delete this interface?',
    editInAdmin: 'Edit in admin',
    filterCat: 'Filter category',
    defaultValues: 'Default values',

    // Admin / editor
    tableOfContents: 'Table of contents',
    interface: 'Interface',
    number: 'Number',
    desc: 'Description',
    include: 'Include',
    addSection: 'Add section',
    fieldsTitle: 'Fields',
    sectionNumber: 'No.',
    renameSection: 'Rename section',
    description: 'Description',
    required: 'Required',
    alphanumeric: 'Alphanumeric',
    numeric: 'Numeric',
    addSeparator: 'Add separator',
    removeSeparator: 'Remove separator',
    moveTo: 'Move to',
    delete: 'Delete',
    addField: 'Add field',
    backToList: 'Back to list',
    editInterface: 'Edit interface',
    maxLen: 'Max length',
    ifaceType: 'Type',
    io: 'I/O',
    renameCategory: 'Rename category',
    addCategory: 'Add category',
    fields: 'Fields',

    // Import/Export / Backup
    exportBackup: 'Export Backup',
    importBackup: 'Import Backup',
    invalidJson: 'Invalid JSON file.',
    importOk: 'Import completed.',
    backupOk: 'Backup imported.',
    exportOk: 'Export done.',
    importOneOk: 'Interface imported.',

    // Workspace
    workspaceProjects: 'Projects',
    newWorkspace: 'New workspace',
    saveWorkspace: 'Save workspace',
    exportWorkspace: 'Export workspace',
    importWorkspace: 'Import workspace',
    deleteWorkspace: 'Delete workspace',
    currentWorkspace: 'Current workspace',
    workspaceName: 'Workspace name',
    workspaceSaved: 'Workspace saved',
workspaceApplied: "Workspace applied",
    autosave: 'Autosave',
    on: 'On',
    off: 'Off',
    apply: 'Apply',
clearColor: 'Clear color',
saveProjectChanges: 'Save project changes',
projectChangesSaved: 'Project changes saved',
workspaceCleared: 'Project cleared',
confirmNewWorkspace: 'Create a new project?',

    csvMode: 'CSV mode',
csvHeader: 'CSV header',
csvSep: 'Sep.',
csvSeparator: 'Separator',
jsonMode: 'JSON mode',
jsonArray: 'JSON as array',
minified: 'Minified',
onlyFilled: 'Only filled',
maxLenFlex: 'Max length: FLEX',

  },

  pl: {
    applyFailed: "Nie uda\u0142o si\u0119 zastosowa\u0107 schematu",
    applyTemplate: "Zastosuj schemat",
    renameTemplate: "Zmie\u0144 nazw\u0119",
    confirmDeleteTemplate: "Usun\u0105\u0107 schemat \u201e{name}\u201d?",
    templateNamePrompt: "Nazwa schematu:",
    saveAsTemplate: "Zapisz jako schemat",
    exportTemplates: "Eksportuj schematy",
    importTemplates: "Importuj schematy",
    templatesEmpty: "Brak schemat\u00f3w",
    templatesMenu: "Schematy",
    templates: "Schematy",
    // Header / top bar
    language: 'Język',
    scheme: 'Schemat kolorów',
    appTitle: 'Generator Interfejsów',

    // Home
    home: 'Strona główna',
    chooseInterface: 'Strona główna',
    clickToGo: 'Wybierz interfejs aby rozpocząć',
    result: 'Wynik',
    segmentation: 'Segmentacja', segRun: 'Segmentuj', segTooltip: 'Wklej wynik i zsegmentuj do pól', segRunTip: 'Uruchom segmentację bieżącego tekstu', segConfirm: 'Wykryto istniejące dane. Ta opcja wyczyści cały generator. Kontynuować?', segSummary: 'Podsumowanie', segRead: 'Odczytane linie', segBad: 'Błędne linie',
    copy: 'Kopiuj',
    combineAll: 'Scal wynik z wielu interfejsów',
    orderInterfaces: 'Kolejność interfejsów',
    download: 'Pobierz',
    clearSection: 'Wyczyść sekcję',
    clear: 'Wyczyść',
    notAllRequired: 'Uzupełnij wszystkie wymagane pola',
    fillDefaults: 'Uzupełnij wartości podstawowe',

    // Sidebar / Menu
    tools: 'Narzędzia',
        searchAria: 'Szukaj',
    clear: 'Wyczyść',

    // Admin / list
    adminPanel: 'Panel administracyjny',
    adminTitle: 'Generator Interfejsów WMS',
    overview: 'Przegląd',
    search: 'Szukaj interfejsu...',
    addInterface: 'Dodaj interfejs',
    export: 'Eksportuj JSON',
    import: 'Importuj WMS (json)',
    importAddNew: 'Dodaj nowy',
    importOverwriteSelected: 'Nadpisz wybrany',
    category: 'Kategoria',
    fieldsCount: 'Liczba pól',
    deleteInterface: 'Usuń interfejs',
    confirmDeleteInterface: 'Na pewno usunąć ten interfejs?',
    editInAdmin: 'Edytuj w panelu',
    filterCat: 'Filtruj kategorię',
    defaultValues: 'Wartości domyślne',

    // Admin / editor
    tableOfContents: 'Spis treści',
    interface: 'Interfejs',
    number: 'Numer',
    desc: 'Opis',
    include: 'Uwzględnij',
    addSection: 'Dodaj sekcję',
    fieldsTitle: 'Pola',
    sectionNumber: 'Nr',
    renameSection: 'Zmień nazwę sekcji',
    description: 'Opis',
    required: 'Wymagane',
    alphanumeric: 'Alfanumeryczne',
    numeric: 'Numeryczne',
    addSeparator: 'Dodaj separator',
    removeSeparator: 'Usuń separator',
    moveTo: 'Przenieś do',
    delete: 'Usuń',
    addField: 'Dodaj pole',
    backToList: 'Wróć do listy',
    editInterface: 'Edycja interfejsu',
    maxLen: 'Maks. długość',
    ifaceType: 'Typ',
    io: 'We/Wy',
    renameCategory: 'Zmień nazwę kategorii',
    addCategory: 'Dodaj kategorię',
    fields: 'Pola',

    // Import/Export / Backup
    exportBackup: 'Eksportuj Backup',
    importBackup: 'Importuj Backup',
    invalidJson: 'Nieprawidłowy plik JSON.',
    importOk: 'Import zakończony.',
    backupOk: 'Backup zaimportowany.',
    exportOk: 'Eksport zakończony.',
    importOneOk: 'Interfejs zaimportowany.',

    // Workspace
    workspaceProjects: 'Projekty',
    newWorkspace: 'Nowy projekt',
    saveWorkspace: 'Zapisz projekt',
    exportWorkspace: 'Eksportuj projekt',
    importWorkspace: 'Importuj projekt',
    deleteWorkspace: 'Usuń projekt',
    currentWorkspace: 'Aktualny projekt',
    workspaceName: 'Nazwa projektu',
    workspaceSaved: 'Projekt zapisany',
workspaceApplied: "Zastosowano projekt",
    autosave: 'Autosejw',
    on: 'Włączony',
    off: 'Wyłączony',
    apply: 'Zastosuj',
clearColor: 'Wyczyść kolor',
saveProjectChanges: 'Zapisz zmiany w projekcie',
projectChangesSaved: 'Zmiany w projekcie zapisane',
workspaceCleared: 'Projekt wyczyszczony',
confirmNewWorkspace: 'Utworzyć nowy projekt?',

    csvMode: 'Tryb CSV',
csvHeader: 'Nagłówek CSV',
csvSep: 'Sep.',
csvSeparator: 'Separator',
jsonMode: 'Tryb JSON',
jsonArray: 'JSON jako tablica',
minified: 'Zminifikowany',
onlyFilled: 'Tylko wypełnione',
maxLenFlex: 'Maks. długość: FLEX',

  },

  fr: {
    applyFailed: "\u00c9chec de l\u2019application",
    applyTemplate: "Appliquer le sch\u00e9ma",
    renameTemplate: "Renommer le sch\u00e9ma",
    confirmDeleteTemplate: "Supprimer le sch\u00e9ma \u00ab\u00a0{name}\u00a0\u00bb ?",
    templateNamePrompt: "Nom du sch\u00e9ma :",
    saveAsTemplate: "Enregistrer comme sch\u00e9ma",
    exportTemplates: "Exporter des sch\u00e9mas",
    importTemplates: "Importer des sch\u00e9mas",
    templatesEmpty: "Aucun sch\u00e9ma",
    templatesMenu: "Sch\u00e9mas",
    templates: "Sch\u00e9mas",
    appTitle: 'Générateur d’interfaces',
    language: 'Langue',
    scheme: 'Schéma de couleurs',
    home: 'Accueil',
    chooseInterface: 'Accueil',
    clickToGo: 'Choisissez une interface pour commencer',
    result: 'Résultat',
    copy: 'Copier',
    download: 'Télécharger',
    clearSection: 'Vider la section',
    clear: 'Vider',
    notAllRequired: 'Veuillez remplir tous les champs obligatoires',
    tools: 'Outils',
    adminPanel: 'Panneau admin',
    adminTitle: 'Générateur d\'interfaces WMS',
    fillDefaults: 'Remplir les valeurs par défaut',
    overview: 'Aperçu',
    search: 'Rechercher une interface...',
    addInterface: 'Ajouter une interface',
    export: 'Exporter JSON',
    import: 'Importer JSON',
    importAddNew: 'Ajouter nouveau',
    importOverwriteSelected: 'Écraser la sélection',
    category: 'Catégorie',
    fieldsCount: 'Champs',
    deleteInterface: 'Supprimer l’interface',
    confirmDeleteInterface: 'Supprimer cette interface ?',
    editInAdmin: 'Modifier dans l’admin',
    filterCat: 'Filtrer la catégorie',
    defaultValues: 'Valeurs par défaut',
    tableOfContents: 'Sommaire',
    interface: 'Interface',
    number: 'Numéro',
    desc: 'Description',
    include: 'Inclure',
    addSection: 'Ajouter une section',
    fieldsTitle: 'Champs',
    sectionNumber: 'N°',
    renameSection: 'Renommer la section',
    description: 'Description',
    required: 'Obligatoire',
    alphanumeric: 'Alphanumérique',
    numeric: 'Numérique',
    addSeparator: 'Ajouter un séparateur',
    removeSeparator: 'Supprimer le séparateur',
    moveTo: 'Déplacer vers',
    delete: 'Supprimer',
    addField: 'Ajouter un champ',
    backToList: 'Retour à la liste',
    editInterface: 'Éditer l’interface',
    maxLen: 'Longueur max',
    ifaceType: 'Type',
    io: 'E/S',
    renameCategory: 'Renommer la catégorie',
    addCategory: 'Ajouter une catégorie',
    fields: 'Champs',
    exportBackup: 'Exporter la sauvegarde',
    importBackup: 'Importer la sauvegarde',
    invalidJson: 'Fichier JSON invalide.',
    importOk: 'Import terminé.',
    backupOk: 'Sauvegarde importée.',
    exportOk: 'Export terminé.',
    importOneOk: 'Interface importée.',
    workspaceProjects: 'Espace de travail',
    newWorkspace: 'Nouvel espace de travail',
    saveWorkspace: 'Enregistrer l’espace',
    exportWorkspace: 'Exporter l’espace',
    importWorkspace: 'Importer l’espace',
    deleteWorkspace: 'Supprimer l’espace',
    currentWorkspace: 'Espace courant',
    workspaceName: 'Nom de l’espace',
    workspaceSaved: 'Espace enregistré',
workspaceApplied: "Espace de travail appliqué",
    autosave: 'Sauvegarde auto',
    on: 'Activé',
    off: 'Désactivé',
    apply: 'Appliquer',
clearColor: 'Effacer la couleur',
saveProjectChanges: 'Enregistrer les modifications du projet',
projectChangesSaved: 'Modifications du projet enregistrées',
workspaceCleared: 'Projet réinitialisé',
confirmNewWorkspace: 'Créer un nouveau projet ?',
    csvMode: 'Mode CSV',
csvHeader: 'En-tête CSV',
csvSep: 'Sép.',
csvSeparator: 'Séparateur',
jsonMode: 'Mode JSON',
jsonArray: 'JSON en tableau',
minified: 'Minifié',
onlyFilled: 'Uniquement remplis',
maxLenFlex: 'Longueur max : FLEX',
  searchAria: 'Rechercher',
  clear: 'Effacer',

  },

  cs: {
    applyFailed: "Nelze pou\u017e\u00edt \u0161ablonu",
    applyTemplate: "Pou\u017e\u00edt \u0161ablonu",
    renameTemplate: "P\u0159ejmenovat \u0161ablonu",
    confirmDeleteTemplate: "Odstranit \u0161ablonu \u201e{name}\u201c?",
    templateNamePrompt: "N\u00e1zev \u0161ablony:",
    saveAsTemplate: "Ulo\u017eit jako \u0161ablonu",
    exportTemplates: "Exportovat \u0161ablony",
    importTemplates: "Importovat \u0161ablony",
    templatesEmpty: "\u017d\u00e1dn\u00e9 \u0161ablony",
    templatesMenu: "\u0160ablony",
    templates: "\u0160ablony",
    appTitle: 'Generátor rozhraní',
    language: 'Jazyk',
    scheme: 'Barevné schéma',
    home: 'Domů',
    chooseInterface: 'Domů',
    clickToGo: 'Vyberte rozhraní pro start',
    result: 'Výsledek',
    copy: 'Kopírovat',
    combineAll: 'Sloučit z více rozhraní',
    orderInterfaces: 'Pořadí rozhraní',
    download: 'Stáhnout',
    clearSection: 'Vymazat sekci',
    clear: 'Vymazat',
    notAllRequired: 'Vyplňte všechna povinná pole',
    tools: 'Nástroje',
    adminPanel: 'Admin panel',
    adminTitle: 'Generátor WMS rozhraní',
    overview: 'Přehled',
    search: 'Hledat rozhraní...',
    fillDefaults: 'Vyplnit výchozí hodnoty',
    addInterface: 'Přidat rozhraní',
    export: 'Export JSON',
    import: 'Import JSON',
    importAddNew: 'Přidat nové',
    importOverwriteSelected: 'Přepsat vybrané',
    category: 'Kategorie',
    fieldsCount: 'Počet polí',
    deleteInterface: 'Smazat rozhraní',
    confirmDeleteInterface: 'Opravdu smazat toto rozhraní?',
    editInAdmin: 'Upravit v adminu',
    filterCat: 'Filtrovat kategorii',
    defaultValues: 'Výchozí hodnoty',
    tableOfContents: 'Obsah',
    interface: 'Rozhraní',
    number: 'Číslo',
    desc: 'Popis',
    include: 'Zahrnout',
    addSection: 'Přidat sekci',
    fieldsTitle: 'Pole',
    sectionNumber: 'Č.',
    renameSection: 'Přejmenovat sekci',
    description: 'Popis',
    required: 'Povinné',
    alphanumeric: 'Alfanumerické',
    numeric: 'Numerické',
    addSeparator: 'Přidat oddělovač',
    removeSeparator: 'Odstranit oddělovač',
    moveTo: 'Přesunout do',
    delete: 'Smazat',
    addField: 'Přidat pole',
    backToList: 'Zpět na seznam',
    editInterface: 'Upravit rozhraní',
    maxLen: 'Max. délka',
    ifaceType: 'Typ',
    io: 'V/V',
    renameCategory: 'Přejmenovat kategorii',
    addCategory: 'Přidat kategorii',
    fields: 'Pole',
    exportBackup: 'Export zálohy',
    importBackup: 'Import zálohy',
    invalidJson: 'Neplatný JSON soubor.',
    importOk: 'Import dokončen.',
    backupOk: 'Záloha importována.',
    exportOk: 'Export dokončen.',
    importOneOk: 'Rozhraní importováno.',
    workspaceProjects: 'Pracovní prostor',
    newWorkspace: 'Nový workspace',
    saveWorkspace: 'Uložit workspace',
    exportWorkspace: 'Export workspace',
    importWorkspace: 'Import workspace',
    deleteWorkspace: 'Smazat workspace',
    currentWorkspace: 'Aktuální workspace',
    workspaceName: 'Název workspace',
    workspaceSaved: 'Workspace uložen',
workspaceApplied: "Pracovní prostor použit",
    autosave: 'Auto-uložení',
    on: 'Zapnuto',
    off: 'Vypnuto',
    apply: 'Použít',
clearColor: 'Vymazat barvu',
saveProjectChanges: 'Uložit změny v projektu',
projectChangesSaved: 'Změny v projektu uloženy',
workspaceCleared: 'Projekt vyčištěn',
confirmNewWorkspace: 'Vytvořit nový projekt?',
    csvMode: 'Režim CSV',
csvHeader: 'Hlavička CSV',
csvSep: 'Sep.',
csvSeparator: 'Oddělovač',
jsonMode: 'Režim JSON',
jsonArray: 'JSON jako pole',
minified: 'Minifikované',
onlyFilled: 'Jen vyplněná',
maxLenFlex: 'Max. délka: FLEX',
  searchAria: 'Hledat',
  clear: 'Vyčistit',

  },

  de: {
    applyFailed: "Anwenden fehlgeschlagen",
    applyTemplate: "Vorlage anwenden",
    renameTemplate: "Vorlage umbenennen",
    confirmDeleteTemplate: "Vorlage \u201e{name}\u201c l\u00f6schen?",
    templateNamePrompt: "Name der Vorlage:",
    saveAsTemplate: "Als Vorlage speichern",
    exportTemplates: "Vorlagen exportieren",
    importTemplates: "Vorlagen importieren",
    templatesEmpty: "Keine Vorlagen",
    templatesMenu: "Vorlagen",
    templates: "Vorlagen",
    appTitle: 'Schnittstellen-Generator',
    language: 'Sprache',
    scheme: 'Farbschema',
    home: 'Startseite',
    chooseInterface: 'Startseite',
    clickToGo: 'Wähle ein Interface zum Starten',
    result: 'Ergebnis',
    copy: 'Kopieren',
    download: 'Herunterladen',
    clearSection: 'Abschnitt leeren',
    clear: 'Leeren',
    fillDefaults: 'Standardwerte ausfüllen',
    notAllRequired: 'Bitte alle Pflichtfelder ausfüllen',
    tools: 'Werkzeuge',
    adminPanel: 'Adminbereich',
    adminTitle: 'WMS-Schnittstellen-Generator',
    overview: 'Übersicht',
    search: 'Interface suchen...',
    addInterface: 'Interface hinzufügen',
    export: 'JSON exportieren',
    import: 'JSON importieren',
    importAddNew: 'Neu hinzufügen',
    importOverwriteSelected: 'Ausgewähltes überschreiben',
    category: 'Kategorie',
    fieldsCount: 'Felder',
    deleteInterface: 'Interface löschen',
    confirmDeleteInterface: 'Dieses Interface wirklich löschen?',
    editInAdmin: 'Im Admin bearbeiten',
    filterCat: 'Kategorie filtern',
    defaultValues: 'Standardwerte',
    tableOfContents: 'Inhaltsverzeichnis',
    interface: 'Interface',
    number: 'Nummer',
    desc: 'Beschreibung',
    include: 'Einbeziehen',
    addSection: 'Sektion hinzufügen',
    fieldsTitle: 'Felder',
    sectionNumber: 'Nr.',
    renameSection: 'Sektion umbenennen',
    description: 'Beschreibung',
    required: 'Pflichtfeld',
    alphanumeric: 'Alphanumerisch',
    numeric: 'Numerisch',
    addSeparator: 'Separator hinzufügen',
    removeSeparator: 'Trennzeichen entfernen',
    moveTo: 'Verschieben nach',
    delete: 'Löschen',
    addField: 'Feld hinzufügen',
    backToList: 'Zurück zur Liste',
    editInterface: 'Interface bearbeiten',
    maxLen: 'Max. Länge',
    ifaceType: 'Typ',
    io: 'E/A',
    renameCategory: 'Kategorie umbenennen',
    addCategory: 'Kategorie hinzufügen',
    fields: 'Felder',
    exportBackup: 'Backup exportieren',
    importBackup: 'Backup importieren',
    invalidJson: 'Ungültige JSON-Datei.',
    importOk: 'Import abgeschlossen.',
    backupOk: 'Backup importiert.',
    exportOk: 'Export abgeschlossen.',
    importOneOk: 'Interface importiert.',
    workspaceProjects: 'Arbeitsbereich',
    newWorkspace: 'Neuer Workspace',
    saveWorkspace: 'Workspace speichern',
    exportWorkspace: 'Workspace exportieren',
    importWorkspace: 'Workspace importieren',
    deleteWorkspace: 'Workspace löschen',
    currentWorkspace: 'Aktueller Workspace',
    workspaceName: 'Workspace-Name',
    workspaceSaved: 'Workspace gespeichert',
workspaceApplied: "Arbeitsbereich angewendet",
    autosave: 'Autospeichern',
    on: 'An',
    off: 'Aus',
    apply: 'Übernehmen',
clearColor: 'Farbe zurücksetzen',
saveProjectChanges: 'Projektänderungen speichern',
projectChangesSaved: 'Projektänderungen gespeichert',
workspaceCleared: 'Projekt zurückgesetzt',
confirmNewWorkspace: 'Neues Projekt erstellen?',
    csvMode: 'CSV-Modus',
csvHeader: 'CSV-Kopfzeile',
csvSep: 'Sep.',
csvSeparator: 'Trennzeichen',
jsonMode: 'JSON-Modus',
jsonArray: 'JSON als Array',
minified: 'Minimiert',
onlyFilled: 'Nur ausgefüllte',
maxLenFlex: 'Max. Länge: FLEX',
    searchAria: 'Suchen',
    clear: 'Leeren',

  },

  es: {
    applyFailed: "Fallo al aplicar",
    applyTemplate: "Aplicar plantilla",
    renameTemplate: "Renombrar plantilla",
    confirmDeleteTemplate: "\u00bfEliminar la plantilla \"{name}\"?",
    templateNamePrompt: "Nombre de la plantilla:",
    saveAsTemplate: "Guardar como plantilla",
    exportTemplates: "Exportar plantillas",
    importTemplates: "Importar plantillas",
    templatesEmpty: "No hay plantillas",
    templatesMenu: "Plantillas",
    templates: "Plantillas",
    appTitle: 'Generador de interfaces',
  // Header / top bar
  language: 'Idioma',
  scheme: 'Esquema de color',

  // Home
  home: 'Inicio',
  chooseInterface: 'Inicio',
  clickToGo: 'Elige una interfaz para empezar',
  result: 'Resultado',
  copy: 'Copiar',
  combineAll: 'Combinar de todas las interfaces',
  orderInterfaces: 'Orden de interfaces',
  download: 'Descargar',
  clearSection: 'Limpiar sección',
  clear: 'Limpiar',
  notAllRequired: 'Por favor, rellena todos los campos obligatorios',
  fillDefaults: 'Rellenar valores predeterminados',

  // Sidebar / Menu
  tools: 'Herramientas',
  searchAria: 'Buscar',
  clear: 'Limpiar',

  // Admin / list
  adminPanel: 'Panel de administración',
  adminTitle: 'Generador de interfaces WMS',
  overview: 'Resumen',
  search: 'Buscar interfaz...',
  addInterface: 'Añadir interfaz',
  export: 'Exportar JSON',
  import: 'Importar WMS (JSON)',
  importAddNew: 'Añadir nuevo',
  importOverwriteSelected: 'Sobrescribir seleccionados',
  category: 'Categoría',
  fieldsCount: 'Campos',
  deleteInterface: 'Eliminar interfaz',
  confirmDeleteInterface: '¿Seguro que quieres eliminar esta interfaz?',
  editInAdmin: 'Editar en administración',
  filterCat: 'Filtrar categoría',
  defaultValues: 'Valores predeterminados',

  // Admin / editor
  tableOfContents: 'Tabla de contenidos',
  interface: 'Interfaz',
  number: 'Número',
  desc: 'Descripción',
  include: 'Incluir',
  addSection: 'Añadir sección',
  fieldsTitle: 'Campos',
  sectionNumber: 'N.º',
  renameSection: 'Renombrar sección',
  description: 'Descripción',
  required: 'Obligatorio',
  alphanumeric: 'Alfanumérico',
  numeric: 'Numérico',
  addSeparator: 'Añadir separador',
  removeSeparator: 'Eliminar separador',
  moveTo: 'Mover a',
  delete: 'Eliminar',
  addField: 'Añadir campo',
  backToList: 'Volver a la lista',
  editInterface: 'Editar interfaz',
  maxLen: 'Longitud máx.',
  ifaceType: 'Tipo',
  io: 'E/S',
  renameCategory: 'Renombrar categoría',
  addCategory: 'Añadir categoría',
  fields: 'Campos',

  // Import/Export / Backup
  exportBackup: 'Exportar copia de seguridad',
  importBackup: 'Importar copia de seguridad',
  invalidJson: 'Archivo JSON no válido.',
  importOk: 'Importación completada.',
  backupOk: 'Copia de seguridad importada.',
  exportOk: 'Exportación realizada.',
  importOneOk: 'Interfaz importada.',

  // Workspace
  workspaceProjects: 'Proyectos',
  newWorkspace: 'Nuevo espacio de trabajo',
  saveWorkspace: 'Guardar espacio de trabajo',
  exportWorkspace: 'Exportar espacio de trabajo',
  importWorkspace: 'Importar espacio de trabajo',
  deleteWorkspace: 'Eliminar espacio de trabajo',
  currentWorkspace: 'Espacio de trabajo actual',
  workspaceName: 'Nombre del espacio de trabajo',
  workspaceSaved: 'Espacio de trabajo guardado',
  workspaceApplied: 'Espacio de trabajo aplicado',
  autosave: 'Autoguardado',
  on: 'Activado',
  off: 'Desactivado',
  apply: 'Aplicar',
  clearColor: 'Borrar color',
  saveProjectChanges: 'Guardar cambios del proyecto',
  projectChangesSaved: 'Cambios del proyecto guardados',
  workspaceCleared: 'Proyecto limpiado',
  confirmNewWorkspace: '¿Crear un proyecto nuevo?',

  csvMode: 'Modo CSV',
  csvHeader: 'Cabecera CSV',
  csvSep: 'Sep.',
  csvSeparator: 'Separador',
  jsonMode: 'Modo JSON',
  jsonArray: 'JSON como array',
  minified: 'Minificado',
  onlyFilled: 'Solo rellenados',
  maxLenFlex: 'Longitud máx.: FLEX',
},

it: {
    applyFailed: "Applicazione non riuscita",
    applyTemplate: "Applica modello",
    renameTemplate: "Rinomina modello",
    confirmDeleteTemplate: "Eliminare il modello \"{name}\"?",
    templateNamePrompt: "Nome del modello:",
    saveAsTemplate: "Salva come modello",
    exportTemplates: "Esporta modelli",
    importTemplates: "Importa modelli",
    templatesEmpty: "Nessun modello",
    templatesMenu: "Modelli",
    templates: "Modelli",
  appTitle: 'Generatore di interfacce',
  // Header / top bar
  language: 'Lingua',
  scheme: 'Schema colori',

  // Home
  home: 'Home',
  chooseInterface: 'Home',
  clickToGo: "Scegli un'interfaccia per iniziare",
  result: 'Risultato',
  copy: 'Copia',
  combineAll: 'Combina da tutte le interfacce',
  orderInterfaces: 'Ordine delle interfacce',
  download: 'Scarica',
  clearSection: 'Pulisci sezione',
  clear: 'Pulisci',
  notAllRequired: 'Per favore, compila tutti i campi obbligatori',
  fillDefaults: 'Compila con i valori predefiniti',

  // Sidebar / Menu
  tools: 'Strumenti',
  searchAria: 'Cerca',
  clear: 'Pulisci',

  // Admin / list
  adminPanel: 'Pannello di amministrazione',
  adminTitle: 'Generatore di interfacce WMS',
  overview: 'Panoramica',
  search: 'Cerca interfaccia...',
  addInterface: 'Aggiungi interfaccia',
  export: 'Esporta JSON',
  import: 'Importa WMS (JSON)',
  importAddNew: 'Aggiungi nuovo',
  importOverwriteSelected: 'Sovrascrivi selezionati',
  category: 'Categoria',
  fieldsCount: 'Campi',
  deleteInterface: 'Elimina interfaccia',
  confirmDeleteInterface: 'Sei sicuro di voler eliminare questa interfaccia?',
  editInAdmin: 'Modifica nel pannello',
  filterCat: 'Filtra categoria',
  defaultValues: 'Valori predefiniti',

  // Admin / editor
  tableOfContents: 'Indice',
  interface: 'Interfaccia',
  number: 'Numero',
  desc: 'Descrizione',
  include: 'Includi',
  addSection: 'Aggiungi sezione',
  fieldsTitle: 'Campi',
  sectionNumber: 'N.',
  renameSection: 'Rinomina sezione',
  description: 'Descrizione',
  required: 'Obbligatorio',
  alphanumeric: 'Alfanumerico',
  numeric: 'Numerico',
  addSeparator: 'Aggiungi separatore',
  removeSeparator: 'Rimuovi separatore',
  moveTo: 'Sposta in',
  delete: 'Elimina',
  addField: 'Aggiungi campo',
  backToList: 'Torna alla lista',
  editInterface: 'Modifica interfaccia',
  maxLen: 'Lunghezza max',
  ifaceType: 'Tipo',
  io: 'I/O',
  renameCategory: 'Rinomina categoria',
  addCategory: 'Aggiungi categoria',
  fields: 'Campi',

  // Import/Export / Backup
  exportBackup: 'Esporta backup',
  importBackup: 'Importa backup',
  invalidJson: 'File JSON non valido.',
  importOk: 'Importazione completata.',
  backupOk: 'Backup importato.',
  exportOk: 'Esportazione completata.',
  importOneOk: 'Interfaccia importata.',

  // Workspace
  workspaceProjects: 'Progetti',
  newWorkspace: 'Nuovo spazio di lavoro',
  saveWorkspace: 'Salva spazio di lavoro',
  exportWorkspace: 'Esporta spazio di lavoro',
  importWorkspace: 'Importa spazio di lavoro',
  deleteWorkspace: 'Elimina spazio di lavoro',
  currentWorkspace: 'Spazio di lavoro attuale',
  workspaceName: 'Nome spazio di lavoro',
  workspaceSaved: 'Spazio di lavoro salvato',
  workspaceApplied: 'Spazio di lavoro applicato',
  autosave: 'Salvataggio automatico',
  on: 'Attivo',
  off: 'Disattivo',
  apply: 'Applica',
  clearColor: 'Pulisci colore',
  saveProjectChanges: 'Salva le modifiche del progetto',
  projectChangesSaved: 'Modifiche del progetto salvate',
  workspaceCleared: 'Progetto ripulito',
  confirmNewWorkspace: 'Creare un nuovo progetto?',

  csvMode: 'Modalità CSV',
  csvHeader: 'Intestazione CSV',
  csvSep: 'Sep.',
  csvSeparator: 'Separatore',
  jsonMode: 'Modalità JSON',
  jsonArray: 'JSON come array',
  minified: 'Minificato',
  onlyFilled: 'Solo compilati',
  maxLenFlex: 'Lunghezza max: FLEX',
}


};

// ----- API -----
export function getLang() {
  try {
    const val = localStorage.getItem(STORAGE_KEY);
    return val || 'en';
  } catch (_) {
    return 'en';
  }
}

export function setLang(lang) {
  try {
    localStorage.setItem(STORAGE_KEY, lang);
  } catch (_) {}
  try {
    document.documentElement.setAttribute('lang', lang);
  } catch (_) {}
}

export function t(key) {
  const lang = getLang();
  const bundle = dict[lang] || dict.en;
  const v = (bundle && bundle[key]) || dict.en[key];
  if (typeof v === 'undefined') {
    try { console.warn('[i18n] Missing key:', key); } catch (_) {}
    return key;
  }
  return v;
}

// Optional helper to extend translations at runtime
export function setTranslations(lang, entries) {
  if (!dict[lang]) dict[lang] = {};
  const src = entries || {};
  for (const k in src) dict[lang][k] = src[k];
}

export function availableLangs() {
  return Object.keys(dict);
}
